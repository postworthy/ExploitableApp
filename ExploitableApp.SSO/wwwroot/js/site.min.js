var ExploitableApp = function (baseURL, userID) {
    return {
        BaseURL: baseURL,
        CurrentUserID: userID,
        IsAdmin: false,
        Init: function () {
            var me = this;
            if (me.CurrentUserID != '') {
                //Check if we are admin    
                me.IsUserAdmin(me.CurrentUserID).done(function (result) {
                    me.IsAdmin = result.isAdmin;
                    if (result.isAdmin) $("[data-show-if-admin]").show();
                });
            }
        },
        IsUserAdmin: function (userID) {
            var me = this;
            return $.ajax({
                url: (me.BaseURL + "/home/isadmin/" + userID).replace('//', '/')
            });
        },
        GetUsersPaged: function (pageIndex, pageSize) {
            var me = this;
            if (me.IsAdmin) {
                return $.ajax({
                    url: (me.BaseURL + "/admin/GetUsersPaged/" + (pageIndex ? pageIndex : "0") + (pageSize ? "?pagesize=" + pageSize : "")).replace('//', '/')
                });
            }
            else return $.Deferred();
        },
        GetUser: function (userID) {
            var me = this;
            if (me.IsAdmin) {
                return $.ajax({
                    url: (me.BaseURL + "/admin/GetUser/" + userID).replace('//', '/')
                });
            }
            else return $.Deferred();
        },
        FindUsers: function (search) {
            var me = this;
            return $.ajax({
                url: (me.BaseURL + "/home/GetUser/?search=" + search).replace('//', '/')
            });
        },
        AccountEmailExists: function (email) {
            var me = this;
            return $.ajax({
                url: (me.BaseURL + "/home/AccountExists/?email=" + email).replace('//', '/')
            });
        }
    };
};